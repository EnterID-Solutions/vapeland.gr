var clickedButtons;var lastProductId=null;var lastQuantity=null;function addToCart(product_id,quantity){quantity=typeof(quantity)!='undefined'?quantity:1;lastProductId=product_id;lastQuantity=quantity;}
function nwaAddToCart(product_id,quantity){quantity=typeof(quantity)!='undefined'?quantity:1;$.ajax({url:'index.php?route=checkout/cart/add',type:'post',data:'product_id='+product_id+'&quantity='+quantity,dataType:'json',success:function(json){$('.success, .warning, .attention, .information, .error').remove();if(json['NWA']){var btn=clickedButtons;offset=$(btn).offset();var leftOffset=offset.left+(parseInt($(btn).width()/2));$('div#NotifyWhenAvailable_popup').css({top:offset.top,left:((offset.left-$('div#NotifyWhenAvailable_popup').width()/2)+$(btn).width()/2)});$('div#NotifyWhenAvailable_popup').fadeIn('slow');$(".NWA_popover-content").load("index.php?route=module/notifywhenavailable/shownotifywhenavailableform&product_id="+product_id);}else{if(json['redirect']){location=json['redirect'];}
if(json['success']){$('#notification').html('<div class="success" style="display: none;">'+json['success']+'<img src="catalog/view/theme/default/image/close.png" alt="" class="close" /></div>');$('.success').fadeIn('slow');$('#cart-total').html(json['total']);$('html, body').animate({scrollTop:0},'slow');}}}});}
$('[onclick^=addToCart]').live('click',function(e){clickedButtons=e.target;nwaAddToCart(lastProductId,lastQuantity);});